(function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))c(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function t(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(n){if(n.ep)return;n.ep=!0;const r=t(n);fetch(n.href,r)}})();const g="acd1a7db8f824fbc9f9bc66185b587f1",y="d19852e69c09421da777af4404682760",b=btoa(`${g}:${y}`),f=function(){return fetch("https://accounts.spotify.com/api/token",{method:"POST",headers:{Authorization:`Basic ${b}`,"Content-Type":"application/x-www-form-urlencoded"},body:"grant_type=client_credentials"}).then(e=>e.json())};tui.Pagination;const u=document.querySelector(".form");document.querySelector(".input");document.querySelector(".btn-search");const d=document.querySelector(".mainListEl"),q=document.querySelector(".artistP"),v=document.querySelector(".songP"),E=document.querySelector(".albumP"),S=document.querySelector(".inModalImg"),k=document.querySelector(".releaseP"),P=document.querySelector(".listenA");let i;const M=function(e,o){return fetch(`https://api.spotify.com/v1/search?q=${e}&type=track&market=KR`,{method:"GET",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}}).then(t=>t.json())},L=function(e,o){return fetch(`https://api.spotify.com/v1/tracks/${e}`,{method:"GET",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}}).then(t=>t.json())};function T(e,o,t){fetch(`https://api.spotify.com/v1/search?q=${e}&type=track&market=KR&limit=20&offset=${t}`,{method:"GET",headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}}).then(c=>c.json()).then(c=>{h(c.tracks.items)})}let m,l;u.addEventListener("submit",e=>{e.preventDefault(),i=e.currentTarget.search.value,f().then(o=>{l=o.access_token,M(i,l).then(t=>{m=t.tracks.total,h(t.tracks.items),new tui.Pagination("tui-pagination-container",{totalItems:m,itemsPerPage:20,visiblePages:5,page:1,centerAlign:!0,template:{page:'<a href="#" class="custom-page">{{page}}</a>',currentPage:'<strong class="custom-page selected">{{page}}</strong>',moveButton:'<a href="#" class="custom-move {{type}}">{{type}}</a>',disabledMoveButton:'<span class="custom-move disabled {{type}}">{{type}}</span>',moreButton:'<a href="#" class="custom-ellipsis">...</a>'}}).on("afterMove",n=>{const s=(n.page-1)*20;T(i,l,s)}),u.reset()})})});function h(e){d.innerHTML="",e.forEach(o=>{d.insertAdjacentHTML("beforeend",$(o))})}const $=function(e){return`
<button data-action="open-modal" id="openModal"><div class="outModal">
  <img class="imgOutModal" id="${e.id}" src="${e.album.images[0].url}" alt="">
  <p class="mainOutModalp ">${e.name}</p>
  <p class="pOutModal">${e.artists[0].name}</p>
  <p class="pOutModal">Album name: ${e.album.name}</p>
</div></button>


`};let p;const O=document.querySelector('[data-action="open-modal"]'),A=document.querySelector(".js-backdrop");document.querySelector(".modal");const C=document.querySelector('[data-action="close-modal"]');function a(e){document.querySelector("#openModal")&&(document.body.classList.toggle("show-modal"),p=e.target.id,f().then(o=>{L(p,o.access_token).then(t=>{q.textContent=t.artists[0].name,v.textContent=t.name,E.textContent=t.album.name,S.src=t.album.images[0].url,k.textContent=t.album.release_date,P.href=t.external_urls.spotify})}))}O.addEventListener("click",a);C.addEventListener("click",a);A.addEventListener("click",e=>{e.currentTarget===e.target&&a()});window.addEventListener("keydown",e=>{e.key==="Escape"&&document.body.classList.contains("show-modal")&&a()});
